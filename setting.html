<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ファストパス設定</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background: #f0f8ff;
    }
    h1 {
      color: #333;
      text-align: center;
    }
    label, input, select, button {
      display: block;
      margin: 10px auto;
      width: 80%;
      max-width: 400px;
    }
    input, select, button {
      padding: 10px;
      font-size: 1em;
    }
    .section {
      background: white;
      padding: 20px;
      margin: 20px auto;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 500px;
    }
  </style>
</head>
<body>
  <h1>ファストパス設定</h1>

  <div class="section">
    <h2>案内時間帯の設定</h2>
    <label>時間帯1（例: 09:00～11:00）</label>
    <input type="text" id="timeRange1" placeholder="09:00-11:00" />

    <label>時間帯2</label>
    <input type="text" id="timeRange2" placeholder="13:00-15:00" />

    <label>時間帯3</label>
    <input type="text" id="timeRange3" placeholder="16:00-18:00" />

    <button onclick="saveTimeSettings()">時間帯を保存</button>
  </div>

  <div class="section">
    <h2>特別ファストパス発券</h2>
    <input type="text" id="specialName" placeholder="名前" />
    <input type="number" id="specialCount" placeholder="人数" />
    <button onclick="issueSpecial()">特別ファストパスを発券</button>
  </div>

  <div class="section">
    <h2>発券の制御</h2>
    <button onclick="setIssuing(true)">発券開始</button>
    <button onclick="setIssuing(false)">発券終了</button>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDibHDpFtKBSCScK0QmB5xjKdBniS2EI1Y",
      authDomain: "fastpass-system.firebaseapp.com",
      projectId: "fastpass-system",
      storageBucket: "fastpass-system.appspot.com",
      messagingSenderId: "858745521872",
      appId: "1:858745521872:web:29289b673855097e1200d5",
      measurementId: "G-SLPKMCNY53"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function saveTimeSettings() {
      const range1 = document.getElementById("timeRange1").value;
      const range2 = document.getElementById("timeRange2").value;
      const range3 = document.getElementById("timeRange3").value;

      db.collection("settings").doc("timeRanges").set({
        ranges: [range1, range2, range3]
      }).then(() => {
        alert("時間帯を保存しました");
      });
    }

    function setIssuing(status) {
      db.collection("settings").doc("status").set({
        issuing: status
      }).then(() => {
        alert(status ? "発券を開始しました" : "発券を終了しました");
      });
    }

    function issueSpecial() {
      const name = document.getElementById("specialName").value;
      const count = parseInt(document.getElementById("specialCount").value, 10);
      if (!name || isNaN(count) || count <= 0) {
        alert("正しい名前と人数を入力してください");
        return;
      }

      db.collection("fastpasses").add({
        name,
        count,
        status: "special",
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        alert("特別ファストパスを発券しました");
        document.getElementById("specialName").value = "";
        document.getElementById("specialCount").value = "";
      });
    }
  </script>
</body>
</html>
