<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>案内時間設定</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
    }
    input, button {
      margin: 0.5rem 0;
      padding: 0.5rem;
    }
  </style>
</head>
<body>
  <h2>案内時間帯設定（最大3枠）</h2>
  <div id="timeInputs"></div>
  <button onclick="save()">保存</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDibHDpFtKBSCScK0QmB5xjKdBniS2EI1Y",
      authDomain: "fastpass-system.firebaseapp.com",
      projectId: "fastpass-system",
      storageBucket: "fastpass-system.firebasestorage.app",
      messagingSenderId: "858745521872",
      appId: "1:858745521872:web:29289b673855097e1200d5",
      measurementId: "G-SLPKMCNY53"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const timeInputs = document.getElementById("timeInputs");

    for (let i = 0; i < 3; i++) {
      timeInputs.innerHTML += `
        <div>
          <label>開始:</label>
          <input type="time" id="start${i}">
          <label>終了:</label>
          <input type="time" id="end${i}">
        </div>
      `;
    }

    async function save() {
      const ranges = [];
      for (let i = 0; i < 3; i++) {
        const start = document.getElementById(`start${i}`).value;
        const end = document.getElementById(`end${i}`).value;
        if (start && end) {
          ranges.push({ start, end });
        }
      }
      await db.collection("settings").doc("timeRanges").set({ ranges });
      alert("保存しました！");
    }

    (async () => {
      const doc = await db.collection("settings").doc("timeRanges").get();
      if (doc.exists) {
        const ranges = doc.data().ranges;
        ranges.forEach((r, i) => {
          document.getElementById(`start${i}`).value = r.start;
          document.getElementById(`end${i}`).value = r.end;
        });
      }
    })();
  </script>
</body>
</html>
